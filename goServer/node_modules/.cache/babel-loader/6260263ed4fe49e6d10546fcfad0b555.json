{"remainingRequest":"/home/wushili/Desktop/myStudy/WaifuFromSketch/node_modules/babel-loader/lib/index.js!/home/wushili/Desktop/myStudy/WaifuFromSketch/node_modules/eslint-loader/index.js??ref--13-0!/home/wushili/Desktop/myStudy/WaifuFromSketch/src/util/store.js","dependencies":[{"path":"/home/wushili/Desktop/myStudy/WaifuFromSketch/src/util/store.js","mtime":1573922199112},{"path":"/home/wushili/Desktop/myStudy/WaifuFromSketch/node_modules/cache-loader/dist/cjs.js","mtime":1572924774051},{"path":"/home/wushili/Desktop/myStudy/WaifuFromSketch/node_modules/babel-loader/lib/index.js","mtime":1572924773995},{"path":"/home/wushili/Desktop/myStudy/WaifuFromSketch/node_modules/eslint-loader/index.js","mtime":1572924774347}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport _getIterator from \"/home/wushili/Desktop/myStudy/WaifuFromSketch/node_modules/@babel/runtime-corejs2/core-js/get-iterator\";\n\n/**\n * Created by wang on 2017/10/25.\n */\nimport Vue from 'vue';\nimport bus from './bus';\nexport default new Vue({\n  data: {\n    userInfo: {},\n    merchantInfo: {},\n    token: ''\n  },\n  methods: {\n    setToken: function setToken(token) {\n      if (token) {\n        var storedToken = localStorage.getItem('hudson.community.token');\n        this.token = token;\n\n        if (token !== storedToken) {\n          localStorage.setItem('hudson.community.token', token);\n        }\n\n        bus.$emit('setToken', token);\n      } else {\n        // 退出登录\n        this.token = '';\n        localStorage.removeItem('hudson.community.token', '');\n      }\n    },\n    setMerchantInfo: function setMerchantInfo(merchantInfo) {\n      this.merchantInfo = merchantInfo;\n      localStorage.setItem('hudson.community.selectMerchantOpenId', this.merchantInfo.merchantOpenId);\n      bus.$emit('setMerchantInfo', merchantInfo);\n    },\n    setUserInfo: function setUserInfo(userInfo) {\n      this.userInfo = userInfo;\n      bus.$emit('setUserInfo', userInfo);\n    },\n    hasRole: function hasRole(role) {\n      // console.log(role)\n      // console.log(this.merchantInfo)\n      if (!this.merchantInfo || !this.merchantInfo.role) return false;\n      if (role === 1001) return this.userInfo.isPlatformManager === 0;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = _getIterator(this.merchantInfo.role), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var x = _step.value;\n          if (role === x) return true;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return false;\n    },\n    hasMod: function hasMod(mod) {\n      // debugger\n      if (!mod) return true;\n      if (!this.merchantInfo || !this.merchantInfo.merchantOpenId) return false;\n\n      if (mod === 'bigData') {\n        return this.merchantInfo.merchantOpenId === 'vybp6LzklDm9sWoby1lOnw' || this.merchantInfo.merchantOpenId === 'undgItb58v3qydbQfHZLmQ';\n      }\n\n      if (this.merchantInfo.merchantOpenId === 'nKBNoWo9rc-GvGOoQvZPrg') {\n        var modEnabled = ['fire', 'smoke', 'water'];\n        return modEnabled.includes(mod);\n      }\n\n      return true;\n    }\n  },\n  created: function created() {\n    // 读取token\n    var storedToken = localStorage.getItem('hudson.community.token');\n    if (storedToken) this.setToken(storedToken); // 读取merchantOpenId\n\n    var selectMerchantOpenId = localStorage.getItem('hudson.community.selectMerchantOpenId');\n    var merchantInfo;\n\n    if (selectMerchantOpenId) {\n      merchantInfo = {\n        merchantOpenId: selectMerchantOpenId\n      };\n      this.setMerchantInfo(merchantInfo);\n    }\n  }\n});",{"version":3,"sources":["/home/wushili/Desktop/myStudy/WaifuFromSketch/src/util/store.js"],"names":["Vue","bus","data","userInfo","merchantInfo","token","methods","setToken","storedToken","localStorage","getItem","setItem","$emit","removeItem","setMerchantInfo","merchantOpenId","setUserInfo","hasRole","role","isPlatformManager","x","hasMod","mod","modEnabled","includes","created","selectMerchantOpenId"],"mappings":"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","sourcesContent":["/**\n * Created by wang on 2017/10/25.\n */\nimport Vue from 'vue'\nimport bus from './bus'\n\nexport default new Vue({\n  data: {\n    userInfo: {},\n    merchantInfo: {},\n    token: ''\n  },\n  methods: {\n    setToken: function (token) {\n      if (token) {\n        let storedToken = localStorage.getItem('hudson.community.token')\n        this.token = token\n        if (token !== storedToken) {\n          localStorage.setItem('hudson.community.token', token)\n        }\n        bus.$emit('setToken', token)\n      } else {\n        // 退出登录\n        this.token = ''\n        localStorage.removeItem('hudson.community.token', '')\n      }\n    },\n    setMerchantInfo: function (merchantInfo) {\n      this.merchantInfo = merchantInfo\n      localStorage.setItem('hudson.community.selectMerchantOpenId', this.merchantInfo.merchantOpenId)\n      bus.$emit('setMerchantInfo', merchantInfo)\n    },\n    setUserInfo: function (userInfo) {\n      this.userInfo = userInfo\n      bus.$emit('setUserInfo', userInfo)\n    },\n    hasRole (role) {\n      // console.log(role)\n      // console.log(this.merchantInfo)\n      if (!this.merchantInfo || !this.merchantInfo.role) return false\n      if (role === 1001) return this.userInfo.isPlatformManager === 0\n      for (let x of this.merchantInfo.role) {\n        if (role === x) return true\n      }\n      return false\n    },\n    hasMod (mod) {\n      // debugger\n      if (!mod) return true\n      if (!this.merchantInfo || !this.merchantInfo.merchantOpenId) return false\n      if (mod === 'bigData') {\n        return (this.merchantInfo.merchantOpenId === 'vybp6LzklDm9sWoby1lOnw' || this.merchantInfo.merchantOpenId === 'undgItb58v3qydbQfHZLmQ')\n      }\n      if (this.merchantInfo.merchantOpenId === 'nKBNoWo9rc-GvGOoQvZPrg') {\n        let modEnabled = ['fire', 'smoke', 'water']\n        return modEnabled.includes(mod)\n      }\n      return true\n    }\n  },\n  created: function () {\n    // 读取token\n    let storedToken = localStorage.getItem('hudson.community.token')\n    if (storedToken) this.setToken(storedToken)\n    // 读取merchantOpenId\n    let selectMerchantOpenId = localStorage.getItem(\n      'hudson.community.selectMerchantOpenId')\n    let merchantInfo\n    if (selectMerchantOpenId) {\n      merchantInfo = {\n        merchantOpenId: selectMerchantOpenId\n      }\n      this.setMerchantInfo(merchantInfo)\n    }\n  }\n})\n"]}]}